{"version":3,"file":"component---src-pages-fields-tsx-6c72d991ea6e9c20a16f.js","mappings":"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","sources":["webpack://gw2-bingo/./src/hooks/fractals.ts","webpack://gw2-bingo/./src/data/index.ts","webpack://gw2-bingo/./src/hooks/dailies.ts","webpack://gw2-bingo/./src/hooks/fields.ts","webpack://gw2-bingo/./src/pages/fields.tsx"],"sourcesContent":["import {useStaticQuery, graphql} from \"gatsby\";\n\nexport interface Fractal {\n    id: number;\n    name: string;\n    display?: string;\n    hasCM: boolean;\n    displayCM?: string;\n    scales: number[];\n}\n\ninterface FractalData {\n    allFractalsJson: {\n        nodes: (Omit<Fractal, \"id\"> & {jsonId: number})[];\n    }\n}\n\nconst useFractalData = () => useStaticQuery<FractalData>(graphql`\n    query {\n        allFractalsJson {\n            nodes {\n                jsonId\n                name\n                display\n                hasCM\n                displayCM\n                scales\n            }\n        }\n    }\n`);\n\nexport const useFractalsWithLobby = (): Fractal[] => useFractalData().allFractalsJson.nodes.map(({jsonId, ...rest}) => ({id: jsonId, ...rest}));\n\nexport const useFractals = (): Fractal[] => useFractalsWithLobby().slice(1);\n\nexport const scaleToTier = (scale: number): number => {\n    if (scale <= 0 || scale >= 100) {\n        return 0;\n    } else if (scale <= 25) {\n        return 1;\n    } else if (scale <= 50) {\n        return 2;\n    } else if (scale <= 75) {\n        return 3;\n    } else {\n        return 4;\n    }\n};\n","/** Date when last updated. */\nexport const DATE: number = Date.UTC(2022, 1, 28); // end of dragons release\n\n/** Offset in the daily rotation. */\nexport const OFFSET = 3;\n","import {useStaticQuery, graphql} from \"gatsby\";\nimport {DATE, OFFSET} from \"../data\";\n\ninterface DailyEntry {\n    _0: number;\n    _1: number;\n    _2: number;\n}\n\ninterface DailyData {\n    allDailiesJson: {\n        nodes: DailyEntry[];\n    }\n    allRecsJson: {\n        nodes: DailyEntry[];\n    }\n}\n\nconst useDailyData = () => useStaticQuery<DailyData>(graphql`\n    query {\n        allDailiesJson {\n            nodes {\n                _0\n                _1\n                _2\n            }\n        }\n        allRecsJson {\n            nodes {\n                _0\n                _1\n                _2\n            }\n        }\n    }\n`);\n\nexport const useDailies = (): number[][] => useDailyData().allDailiesJson.nodes.map(({_0, _1, _2}) => [_0, _1, _2]);\n\nexport const useRecs = (): number[][] => useDailyData().allRecsJson.nodes.map(({_0, _1, _2}) => [_0, _1, _2]);\n\n/** One day in milliseconds. */\nconst DAY = 24 * 60 * 60 * 1000;\n\n/** Returns the index in the daily rotation for a given date. */\nconst indexFor = (date: Date) => {\n    // calculate time passed since last update\n    const passed = date.getTime() - DATE;\n\n    // index is days passed\n    return (Math.floor(passed / DAY) + OFFSET) % 15;\n};\n\n/** Returns the fractal daily ids for a given date. */\nexport const useDailiesFor = (date: Date): number[] => useDailies()[indexFor(date)];\n\n/** Returns the fractal rec scales for a given date. */\nexport const useRecsFor = (date: Date): number[] => useRecs()[indexFor(date)];\n\n/** Returns todays fractal daily ids. */\nexport const useTodaysDailies = (): number[] => useDailiesFor(new Date());\n\n/** Returns todays fractal rec scales. */\nexport const useTodaysRecs = (): number[] => useRecsFor(new Date());\n","import {useStaticQuery, graphql} from \"gatsby\";\nimport {Fractal} from \"./fractals\";\nimport {Item} from \"../components/elements\";\n\nexport const enum Mode {\n    Normal = \"Normal\",\n    CM = \"CM\",\n    Both = \"Both\"\n}\n\nexport interface Field {\n    fractal: string;\n    mode?: Mode;\n    encounter?: string;\n    event: string;\n}\n\ninterface FieldData {\n    allFieldsJson: {\n        totalCount: number;\n        nodes: Field[];\n    }\n}\n\nconst useFieldData = () => useStaticQuery<FieldData>(graphql`\n    query {\n        allFieldsJson {\n            totalCount\n            nodes {\n                fractal\n                mode\n                encounter\n                event\n            }\n        }\n    }\n`);\n\nexport const useFields = (): Field[] => useFieldData().allFieldsJson.nodes;\n\nexport const useFieldCount = (): number => useFieldData().allFieldsJson.totalCount;\n\n/** Generates a set of random field IDs */\nexport const randomFields = (all: Field[], whitelist: Field[]): number[] => {\n    if (whitelist.length < 9) {\n        return [];\n    } else {\n        const result: number[] = [];\n        while (result.length < 9) {\n            const generated = whitelist[Math.floor(Math.random() * whitelist.length)];\n            const id = all.indexOf(generated);\n            if (!result.includes(id)) {\n                result.push(id);\n            }\n        }\n        return result;\n    }\n};\n\n/** Converts field data to an item. */\nexport const toItem = (fractals: Fractal[], {fractal, mode, encounter, event}: Field): Item => {\n    const found = fractals.find(({name}) => name === fractal);\n    const display = mode === Mode.CM\n        ? `${found ? found.displayCM ?? found.name : fractal} CM`\n        : found ? found.display ?? found.name : fractal;\n    return {\n        title: encounter ? `${display} - ${encounter}` : display,\n        content: event\n    };\n};\n","import React from \"react\";\nimport {Layout} from \"../components/layout\";\nimport {Paragraph, List} from \"../components/elements\";\nimport {useFields, toItem, Field, useFractals, Mode} from \"../hooks\";\n\nconst cms = [\n    \"All\",\n    \"Old\",\n    \"Nightmare\",\n    \"Shattered Observatory\",\n    \"Sunqua Peak\"\n];\n\nconst encounters = [\n    \"MAMA\",\n    \"Bullet Hell\",\n    \"Siax\",\n    \"Ensolyss\",\n    \"Skorvald\",\n    \"Artsariiv\",\n    \"Arkk\",\n    \"Ai\",\n    \"Elemental Ai\",\n    \"Dark Ai\"\n];\n\nconst scale = ({fractal, mode}: Field) => {\n    if (mode === Mode.CM) {\n        // cms at end\n        return 2 + cms.indexOf(fractal);\n    } else if (fractal === \"All\") {\n        // all to front\n        return -2;\n    } else if (fractal === \"Dailies\") {\n        // dailies after\n        return -1;\n    } else {\n        // normal for regular\n        return 0;\n    }\n};\n\nconst compare = (a: Field, b: Field) => {\n    const scaleA = scale(a);\n    const scaleB = scale(b);\n\n    // order of encounters within the CM fractals\n    const encounterA = a.encounter ? encounters.indexOf(a.encounter) : -2;\n    const encounterB = b.encounter ? encounters.indexOf(b.encounter) : -2;\n\n    // sort by scale\n    if (scaleA < scaleB) {\n        return -1;\n    } else if (scaleA > scaleB) {\n        return 1;\n    } else if (a.mode === Mode.CM) {\n        // sort cms by encounter\n        if (encounterA < encounterB) {\n            return -1;\n        } else if (encounterA > encounterB) {\n            return 1;\n        }\n    }\n\n    return a.fractal.localeCompare(b.fractal);\n};\n\nconst Fields = (): JSX.Element => {\n    const fractals = useFractals();\n    const fields = useFields();\n\n    return (\n        <Layout title=\"Bingo Fields\">\n            <Paragraph align=\"center\">\n                Total count: {fields.length} bingo fields\n            </Paragraph>\n            <List>\n                {[...fields].sort(compare).map((field) => toItem(fractals, field))}\n            </List>\n        </Layout>\n    );\n};\n\nexport default Fields;\n"],"names":["useFractalsWithLobby","useStaticQuery","allFractalsJson","nodes","map","_ref","jsonId","rest","id","useFractals","slice","scaleToTier","scale","DATE","Date","UTC","useDailyData","indexFor","date","passed","getTime","Math","floor","useDailiesFor","allDailiesJson","_0","_1","_2","useRecsFor","allRecsJson","_ref2","useTodaysDailies","useTodaysRecs","Mode","useFieldData","useFields","allFieldsJson","useFieldCount","totalCount","randomFields","all","whitelist","length","result","generated","random","indexOf","includes","push","toItem","fractals","_found$displayCM","_found$display","fractal","mode","encounter","event","found","find","name","display","CM","displayCM","title","content","cms","encounters","compare","a","b","scaleA","scaleB","encounterA","encounterB","localeCompare","Fields","fields","React","Layout","Paragraph","align","List","_toConsumableArray","sort","field"],"sourceRoot":""}